

var maxi = " mat = NULL; var = NULL; x = NULL; row = NULL; col = NULL; pivotcol = NULL; pivotrow = NULL; i = NULL; j = NULL; k = NULL; normalized = NULL; cnt = NULL; names = NULL; slack = NULL; label = NULL; solutionSet = NULL; iter = NULL; temp = NULL; diagSlack = NULL; newmat = NULL; tempstring = NULL; Simplex <- function(f, verbose){   matlist = NULL; sslist = NULL; colLabel =  NULL;  mat = AugCoeffMatrix(f)$augcoeffmatrix;   var = AugCoeffMatrix(f)$variables;   row = nrow(mat);         diagSlack = diag(x = 1, nrow(mat) );   for (k in 1:length(var)){     newmat = cbind (newmat, mat[,k]);   };   newmat = cbind(newmat, diagSlack);   newmat = cbind(newmat, mat[,ncol(mat)]);   mat = newmat;      col = ncol(mat);   slack = c(paste(\"s\", 1:nrow(mat), sep=\"\"));   label = c(var, slack, \"S\");     colLabel=list(c(1:row), label); dimnames(mat)=colLabel;   iter = 1;   solutionSet = c();   while( min(mat[nrow(mat), ]) < 0){     solutionSet = c();     pivotcol = which.min((mat[nrow(mat), ]));     temp = c();     for (i in 1:nrow(mat)){       x = as.numeric(mat[i, col]/mat[i,pivotcol]);       if(as.numeric(mat[i, col] == 0) || ( x == Inf) || ( x < 0)  ){         temp = c(temp, Inf);       }else {         temp = c(temp, x);       };     };     pivotrow = as.numeric(which.min(abs(temp)));     mat[pivotrow, ] = round(mat[pivotrow, ] / as.numeric(mat[pivotrow, pivotcol]), digits = 4);     for(j in 1:nrow(mat)){       if(as.numeric(mat[j,pivotcol]) == 0 || (j == pivotrow)) {         next;       };       normalized =  round(mat[pivotrow,] * as.numeric(mat[j,pivotcol]), digits = 4);       mat[j,] = round(mat[j,] - normalized, digits = 4);       if(verbose){         print(paste(\"Resulting Matrix after new eval_row\", j, \"iteration\", iter),quote = FALSE);         print(mat);       };     };      solutionSet = c();     for(j in 1:col){       cnt = 0;       for(k in 1:nrow(mat)){         if (mat[k,j] == 0){           cnt = cnt + 1;         };         if(mat[k,j] == 1){           temp = mat[k,col];         };       };       if ( (max(mat[ ,j]) == 1 ) && (cnt<=nrow(mat) || (cnt==(nrow(mat)-1)))){         solutionSet = c(solutionSet, temp);       }else{         solutionSet = c(solutionSet, 0);       };     };     names(solutionSet)=label;     if(verbose){        print(paste(\"******************************************\"),quote = FALSE);       print(paste(\"Resulting Matrix after Iteration\", iter),quote = FALSE);       print(mat);       print(paste(\"Solution Set: \"),quote = FALSE);       print(solutionSet);       print(paste(\"******************************************\"),quote = FALSE);      };     matlist[[iter]] <- mat; sslist[[iter]] = solutionSet;     iter=iter+1;      if(min((mat[row, ]))>0) break;   };     if(verbose){     print(paste(\"Resulting Matrix for Simplex\"),quote = FALSE);     print(mat);     print(paste(\"Solution Set: \"),quote = FALSE);     print(solutionSet);   };   result = list(mat = matlist, sslist = sslist, solutionSet = solutionSet, x1 = solutionSet[1], x2 = solutionSet[2], colLabel = colLabel);   return (result); };  AugCoeffMatrix <- function(mylist){   i = 1;   l = c();   len = length(mylist);   for (i in 1:length(mylist)){     temp = deparse((mylist[[i]]));     l = c(l , temp);   };    i=1;   for (i in 1:length(l)){     if(i %% 2 == 0){       temp = l[i];       temp2 = unlist(strsplit(temp, \"[[:space:]]\"));       j=1;       vars = grep(\"x+\", temp2, perl=TRUE, value=TRUE);       line = grep(\"^[-+]?[0-9]*\\\\.?[0-9]+\", temp2, perl=TRUE, value=TRUE);        newval = c();       for (x in 1:length(vars)){         index = substring(vars[x],2);         index = as.numeric(index);          if (x == index ){           newval = c(newval, line[x]);         }         else{           newval[index] = line[x];          };       };       newval[length(vars)+1] = line[length(vars)+1];         newval = as.numeric(newval);       linelen = length(newval);       newval[linelen] = newval[linelen]*-1;        if (i == 2){         mat = newval;       }else{         mat = rbind(mat, newval);       };     };   }; colLabel=list(c(1:len), c(vars, \"RHS\"));  dimnames(mat)=colLabel;   result = list (variables=c(vars),augcoeffmatrix=mat);   return (result); }; Simplex(f, TRUE);"
var mini = "tempmat = NULL; mat = NULL; var = NULL; x = NULL; row = NULL; col = NULL; pivotcol = NULL; pivotrow = NULL; i = NULL; j = NULL; k = NULL; normalized = NULL; cnt = NULL; names = NULL; slack = NULL; label = NULL; solutionSet = NULL; iter = NULL; temp = NULL; diagSlack = NULL; newmat = NULL; tempstring = NULL;  Simplex <- function(f, verbose){   matlist = NULL;   mat = AugCoeffMatrix(f)$augcoeffmatrix;   var = AugCoeffMatrix(f)$variables;   row = nrow(mat);   mat[row,] = mat[row,] *-1;      diagSlack = diag(x = 1, nrow(mat) );   for (k in 1:ncol(mat)-1){     newmat = cbind (newmat, mat[,k]);   };   newmat = cbind(newmat, diagSlack);   newmat = cbind(newmat, mat[,ncol(mat)]);   mat = newmat;        col = ncol(mat);       mat[,col] = mat[,col] *-1;      iter = 1;   solutionSet = c();   while( min(mat[nrow(mat), ]) < 0){     solutionSet = c();     pivotcol = which.min((mat[nrow(mat), ]));     temp = c();     for (i in 1:nrow(mat)){       x = as.numeric(mat[i, col]/mat[i,pivotcol]);       if(as.numeric(mat[i, col] == 0) || ( x == Inf) || ( x < 0)  ){         temp = c(temp, Inf);       }else {         temp = c(temp, x);       };     };     pivotrow = as.numeric(which.min(abs(temp)));     mat[pivotrow, ] = round(mat[pivotrow, ] / as.numeric(mat[pivotrow, pivotcol]), digits = 4);     for(j in 1:nrow(mat)){       if(as.numeric(mat[j,pivotcol]) == 0 || (j == pivotrow)) {         next;       };       normalized =  round(mat[pivotrow,] * as.numeric(mat[j,pivotcol]), digits = 4);       mat[j,] = round(mat[j,] - normalized, digits = 4);       if(verbose){         print(paste(\"Resulting Matrix after new eval_row\", j, \"iteration\", iter),quote = FALSE);         print(mat);       };     };      solutionSet = c();     for(j in 1:col){       cnt = 0;       for(k in 1:nrow(mat)){         if (mat[k,j] == 0){           cnt = cnt + 1;         };         if(mat[k,j] == 1){           temp = mat[k,col];         };       };       if ( (max(mat[ ,j]) == 1 ) && (cnt<=nrow(mat) || (cnt==(nrow(mat)-1)))){         solutionSet = c(solutionSet, temp);       }else{         solutionSet = c(solutionSet, 0);       };     };     names(solutionSet)=label;     if(verbose){        print(paste(\"******************************************\"),quote = FALSE);       print(paste(\"Resulting Matrix after Iteration\", iter),quote = FALSE);       print(mat);       print(paste(\"Solution Set: \"),quote = FALSE);       print(solutionSet);       print(paste(\"******************************************\"),quote = FALSE);      };     matlist[[iter]] <- mat;     iter=iter+1;      if(min((mat[row, ]))>0) break;   };    if(verbose){     print(paste(\"Resulting Matrix for Simplex\"),quote = FALSE);     print(mat);     print(paste(\"Solution Set: \"),quote = FALSE);     print(solutionSet);   }; tempmat = mat[nrow(mat), ];  result = list(mat = matlist, solutionSet = tempmat, x1 = solutionSet[1], x2 = solutionSet[2]);   return (result); };  AugCoeffMatrix <- function(mylist){   i = 1;   l = c();   len = length(mylist);   for (i in 1:length(mylist)){     temp = deparse((mylist[[i]]));     l = c(l , temp);   };      i=1;   for (i in 1:length(l)){     if(i %% 2 == 0){       temp = l[i];       temp2 = unlist(strsplit(temp, \"[[:space:]]\"));       j=1;       vars = grep(\"x+\", temp2, perl=TRUE, value=TRUE);       line = grep(\"^[-+]?[0-9]*\\\\.?[0-9]+\", temp2, perl=TRUE, value=TRUE);              newval = c();       for (x in 1:length(vars)){         index = substring(vars[x],2);         index = as.numeric(index);                  if (x == index ){           newval = c(newval, line[x]);         }         else{           newval[index] = line[x];                    };       };       newval[length(vars)+1] = line[length(vars)+1];                     newval = as.numeric(newval);       linelen = length(newval);       newval[linelen] = newval[linelen]*-1;              if (i == 2){         mat = newval;       }else{         mat = rbind(mat, newval);       };     };   };   print(mat);   newmat = t(mat);   print(mat);      row = nrow(mat);   result = list (variables=c(vars),augcoeffmatrix=newmat);   return (result); }; Simplex(f, TRUE);";
var dietString = "equation<-NULL; pos<-NULL; ing<-NULL; variables<-c(); simplex <- function(mat, verbose=TRUE) {   mat = AugCoeffMatrix(mat)$augcoeffmatrix; mat = t(mat); mat[nrow(mat), ] = mat[nrow(mat), ] * -1;   mat = cbind(mat[ , 1:ncol(mat)-1], diag(nrow(mat)), mat[ , ncol(mat)]);   print(\"Given matrix\");   print(mat);   for (num in seq(1, 10000, by=1)) {     minNegPos = which.min(mat[nrow(mat), ]);     if(min(mat[nrow(mat), ]) >= 0) {       return(mat[nrow(mat), ]);     };          x = mat[ , minNegPos];          x = mat[ , ncol(mat)] / x;          x = x[1:length(x)-1];          minPosPos = which(x == min(x[which(x > 0)]));          mat[minPosPos, ] = mat[minPosPos, ] / mat[minPosPos, minNegPos];          for (i in seq(1, nrow(mat), by=1)) {    if(length(minPosPos) == 0) return (0);    if (i == minPosPos) next;       mat[i, ] = mat[i,] - (mat[i, minNegPos] * mat[minPosPos, ]);      };          print(paste(\"Iteration \", num));      print(mat); };  return(mat);        };      AugCoeffMatrix <- function(system) {      for (i in seq(1, length(system), by=1)) {          current <- unlist(system[i]);     current <- deparse(current);          for (x in seq(2, length(current), by=1)) {       equation <- paste(equation, current[x], sep=\"\");     };     current = equation;     equation = NULL;          substr(current, nchar(current), nchar(current)) = \" \";          current <- strsplit(current, \"\\\\s+\");     current <- unlist(current);    for (y in seq(1, length(current), by=1)) {       if (is.na(as.numeric(current[y]))) {         current[y] <- \"\";       } else {         break;       };     };      variableIndex = grep(\"x\", current);          if (i > 1) {       if (csize != length(variableIndex)+1) {       };     };          csize <- length(variableIndex)+1;          for (x in seq(1, length(variableIndex), by=1)) {       pos[length(pos)+1] = as.numeric(substr(current[variableIndex[x]], 2, 3));     };          for (x in seq(1, length(variableIndex), by=1)) {       ing[length(ing)+1] = as.numeric(current[variableIndex[pos[x]]-2]);     };     for (x in seq(1, length(current), by=1)) {       if (substr(current[x], 1, 1) != \"x\") {         if (x == length(current)) {           ing[length(ing)+1] = current[x];         } else if (grepl(\"\\\\+\", current[x+1])) {            ing[length(ing)+1] = current[x];         };       };     };               pos = c();   };      ing <- as.numeric(ing);      for (i in seq(csize, length(ing), by=csize)) {     ing[i] = ing[i] * -1;   };      mat = matrix(c(ing), nrow=length(system), ncol=csize, byrow=TRUE);      for (i in seq(1, csize-1, by=1)) {     variables[length(variables)+1] = paste(\"x\", i, sep=\"\");   };         rownames(mat) <- 1:length(system);   colnames(mat) <- c(variables, \"RHS\");      return(list(variables=variables, augcoeffmatrix=mat));    }; simplex(f);";

